{php}$title = "后台首页";{/php}
{include file="layout/header" /}
    <!--页面主要内容-->
<main class="lyear-layout-content">

  <div class="container-fluid p-t-15">

    <div class="row">
      <div class="col-md-6 col-xl-3">
        <div class="card bg-primary text-white">
          <div class="card-body clearfix">
            <div class="flex-box">
              <span class="img-avatar img-avatar-48 bg-translucent"><i class="mdi mdi-android fs-22"></i></span>
              <span class="fs-22 lh-22">{$data.apptotal}</span>
            </div>
            <div class="text-right">app数量</div>
          </div>
        </div>
      </div>

      <div class="col-md-6 col-xl-3">
        <div class="card bg-danger text-white">
          <div class="card-body clearfix">
            <div class="flex-box">
              <span class="img-avatar img-avatar-48 bg-translucent"><i class="mdi mdi-account fs-22"></i></span>
              <span class="fs-22 lh-22">{$data.usertotal}</span>
            </div>
            <div class="text-right">用户总数</div>
          </div>
        </div>
      </div>

      <div class="col-md-6 col-xl-3">
        <div class="card bg-success text-white">
          <div class="card-body clearfix">
            <div class="flex-box">
              <span class="img-avatar img-avatar-48 bg-translucent"><i class="mdi mdi-credit-card fs-22"></i></span>
              <span class="fs-22 lh-22">{$data.kmtotal}</span>
            </div>
            <div class="text-right">卡密总数</div>
          </div>
        </div>
      </div>

      <div class="col-md-6 col-xl-3">
        <div class="card bg-purple text-white">
          <div class="card-body clearfix">
            <div class="flex-box">
              <span class="img-avatar img-avatar-48 bg-translucent"><i class="mdi mdi-comment-outline fs-22"></i></span>
              <span class="fs-22 lh-22">{$data.messagetotal} 条</span>
            </div>
            <div class="text-right">笔记总数</div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">

      <div class="col-md-6">
        <div class="card">
          <div class="card-header">
            <div class="card-title">注册用户数量(统计数据库中最近的7天)</div>
          </div>
          <div class="card-body">
            <canvas class="js-chartjs-bars"></canvas>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card">
          <div class="card-header">
            <div class="card-title">每天用户总量(统计数据库中最近的7天)</div>
          </div>
          <div class="card-body">
            <canvas class="js-chartjs-lines"></canvas>
          </div>
        </div>
      </div>

    </div>

    <div class="row">
      <div class="col-lg-12">
        <div class="card text-black">
          <header class="card-header">
            <div class="card-title">项目信息</div>
          </header>
          <div class="card-body">
            <table class="table table-hover">
              <tbody>
              <tr><td>项目名称：默然iApp后台管理系统</td></tr>
              <tr><td>项目版本：1.0</td></tr>
              <tr><td>项目作者：默然</td></tr>
              <tr><td>项目地址：<a href="https://gitee.com/morannb/moranht" target="_blank">https://gitee.com/morannb/moranht</a></td></tr>
              <tr><td>交&nbsp;&nbsp;流&nbsp;&nbsp;群：<a href="https://jq.qq.com/?_wv=1027&k=KNpWcDmS" target="_blank">219348005</a></td></tr>
              <tr><td>鸣&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;谢：<a href="http://lyear.itshubao.com/v4/index.html" target="_blank">光年(Light Year Admin V4)后台管理系统模板</a></td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>
    <!--End 页面主要内容-->
  </div>
</div>
{include file="layout/footer" /}
<script type="text/javascript">
  function date(){
    $.ajax({
      type : "get",
      url : "{:url('index/getWeekRegister')}",
      dataType : "json", //返回数据形式为json
      async: false, //同步传输，并添加返回值，返回值应为已定义的全局变量 如a
      success : function(data) {
        a = data.data.date;
      }

    });
    return a;
  }
  function count(){
    $.ajax({
      type : "get",
      url : "{:url('index/getWeekRegister')}",
      dataType : "json", //返回数据形式为json
      async: false, //同步传输，并添加返回值，返回值应为已定义的全局变量 如a
      success : function(data) {
        a = data.data.count;
      }

    });
    return a;
  }
  function month(){
    $.ajax({
      type : "get",
      url : "{:url('index/getmonthusernum')}",
      dataType : "json", //返回数据形式为json
      async: false, //同步传输，并添加返回值，返回值应为已定义的全局变量 如a
      success : function(data) {
        a = data.data.month;
      }

    });
    return a;
  }
  function usernum(){
    $.ajax({
      type : "get",
      url : "{:url('index/getmonthusernum')}",
      dataType : "json", //返回数据形式为json
      async: false, //同步传输，并添加返回值，返回值应为已定义的全局变量 如a
      success : function(data) {
        a = data.data.usernum;
      }

    });
    return a;
  }
$(document).ready(function(e) {
    var $dashChartBarsCnt  = jQuery( '.js-chartjs-bars' )[0].getContext( '2d' ),
        $dashChartLinesCnt = jQuery( '.js-chartjs-lines' )[0].getContext( '2d' );
    var $dashChartBarsData = {
		labels: date(),
		datasets: [
			{
				label: '注册用户',
                borderWidth: 1,
                borderColor: 'rgba(0, 0, 0, 0)',
				backgroundColor: 'rgba(51, 202, 185, 0.5)',
                hoverBackgroundColor: "rgba(51, 202, 185, 0.7)",
                hoverBorderColor: "rgba(0, 0, 0, 0)",
				data: count()
			}
		]
	};
    var $dashChartLinesData = {
		labels: month(),
		datasets: [
			{
				label: '用户数量',
				data: usernum(),
				borderColor: '#358ed7',
				backgroundColor: 'rgba(53, 142, 215, 0.175)',
                borderWidth: 1,
                fill: false,
                lineTension: 0.5
			}
		]
	};
    
    new Chart($dashChartBarsCnt, {
        type: 'bar',
        data: $dashChartBarsData
    });

    var myLineChart = new Chart($dashChartLinesCnt, {
        type: 'line',
        data: $dashChartLinesData,
    });
});
</script>
</body>
</html>